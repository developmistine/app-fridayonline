import 'package:flutter/material.dart';
import 'package:fridayonline/member/components/profile/affiliate/utils/content.dart';
import 'package:fridayonline/member/controller/affiliate/affiliate.content.ctr.dart';
import 'package:get/get.dart';

const cetegoryData = [
  {
    "content_type": 3,
    "content_detail": [
      {
        "content_id": 409,
        "action_type": 4,
        "action_value": "409",
        "show_content_name": true,
        "content_name": "House of Mistine ผลิตภัณฑ์เครื่องหอม",
        "start_date": "",
        "end_date": "",
        "show_image": false,
        "image": "https://ct.fridayth.com/b2c/product/no-image/no-image.jpg",
        "image_desktop":
            "https://ct.fridayth.com/b2c/product/no-image/no-image.jpg",
        "product_content": [
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10054,
            "title":
                "KAO YAI REED DIFFUSER  50 ML เขาใหญ่ รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10054/img/20250509143222_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10053,
            "title":
                "DOI INTHANON REED DIFFUSER  50 ML ดอยอินทนนท์ รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10053/img/20250509143928_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10052,
            "title":
                "AYUTTHAYA REED DIFFUSER  50 ML อยุธยา รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10052/img/20250509143526_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10051,
            "title":
                "ANDAMAN REED DIFFUSER  50 ML อันดามัน รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10051/img/20250509143547_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10050,
            "title": "PAI REED DIFFUSER  50 ML ปาย รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10050/img/20250509143610_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10041,
            "title": "PAI REED DIFFUSER  60 ML. ปาย รีด ดิฟฟิวเซอร์  60 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 250,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://ct.fridayth.com/b2c/product/000025/10041/img/20250509143949_1.webp",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          }
        ]
      }
    ]
  },
  {
    "content_type": 3,
    "content_detail": [
      {
        "content_id": 409,
        "action_type": 4,
        "action_value": "409",
        "show_content_name": true,
        "content_name": "ของน่ารัก",
        "start_date": "",
        "end_date": "",
        "show_image": false,
        "image": "https://ct.fridayth.com/b2c/product/no-image/no-image.jpg",
        "image_desktop":
            "https://ct.fridayth.com/b2c/product/no-image/no-image.jpg",
        "product_content": [
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10052,
            "title":
                "AYUTTHAYA REED DIFFUSER  50 ML อยุธยา รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://i.pinimg.com/736x/6a/54/b4/6a54b49bfa120750f1f66485db21445c.jpg",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10051,
            "title":
                "ANDAMAN REED DIFFUSER  50 ML อันดามัน รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://i.pinimg.com/1200x/98/0c/90/980c9060eee95f0452f785b25503d506.jpg",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
          {
            "icon":
                "https://ct.fridayth.com/b2c/seller/000025/logo20250711172456_0.jpg",
            "product_id": 10050,
            "title": "PAI REED DIFFUSER  50 ML ปาย รีด ดิฟฟิวเซอร์  50 มล.",
            "discount": 0,
            "price": 0,
            "price_before_discount": 413,
            "labels": [],
            "rating_star": 0,
            "have_video": true,
            "unit_sales": "",
            "image":
                "https://i.pinimg.com/736x/8a/84/e0/8a84e0991e9c666562b3f0ef70aa19a0.jpg",
            "currency": "",
            "is_image_overlayed": false,
            "image_overlay": "https://ct.fridayth.com/b2c/file/frame1.png",
            "is_out_of_stock": false
          },
        ]
      }
    ]
  },
];

class ShopCategory extends StatelessWidget {
  const ShopCategory({super.key, required this.index});
  final int index;

  @override
  Widget build(BuildContext context) {
    final bool isEmpty = cetegoryData.isEmpty;

    final affContentCtl = Get.find<AffiliateContentCtr>();

    WidgetsBinding.instance.addPostFrameCallback((_) {
      affContentCtl.categoryEmpty.value = isEmpty;
    });

    return CustomScrollView(
      key: const PageStorageKey('tab_shop_content'),
      slivers: [
        SliverOverlapInjector(
          handle: NestedScrollView.sliverOverlapAbsorberHandleFor(context),
        ),
        if (isEmpty)
          SliverFillRemaining(
            hasScrollBody: false,
            child: Padding(
              padding: const EdgeInsets.all(8),
              child: buildEmptyBox('ไม่พบหมวดหมู่', 'โปรดสร้างหมวดหมู่สินค้า',
                  'สร้างหมวดหมู่', index),
            ),
          )
        else ...[
          SliverPadding(
            padding: const EdgeInsets.all(6),
            sliver: SliverGrid(
              delegate: SliverChildBuilderDelegate(
                (context, itemIndex) {
                  final Map<String, dynamic> items =
                      (cetegoryData[itemIndex] as Map).cast<String, dynamic>();

                  return buildCategorySection(items);
                },
                childCount: cetegoryData.length,
              ),
              gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
                crossAxisCount: 2,
                mainAxisSpacing: 4,
                crossAxisSpacing: 4,
                childAspectRatio: 0.94,
              ),
            ),
          ),
        ],
      ],
    );
  }
}
